# -*- Python -*-

import os
import lit
import pathlib

config.name = 'gazer'
config.test_format = lit.formats.ShTest()
config.test_source_root = os.path.dirname(__file__)
config.suffixes = ['.c', '.ll']
config.excludes = [
    "errors.c"
]
try:
    gazer_script_path = os.environ['GAZER_SCRIPT_PATH']
except KeyError:
    lit_config.fatal('Missing GAZER_SCRIPT_PATH environment variable.')

lit_config.note('Found gazer at {0}'.format(gazer_script_path))

try:
    gazer_tools_dir = os.environ['GAZER_TOOLS_DIR']
except KeyError:
    lit_config.fatal('Missing GAZER_TOOLS_DIR environment variable.')


config.environment['GAZER_TOOLS_DIR'] = gazer_tools_dir

config.substitutions.append(('%gazer', gazer_script_path))
config.substitutions.append(('%errors', os.path.join(os.path.dirname(__file__), "errors.c")))

config.available_features.add('memory')